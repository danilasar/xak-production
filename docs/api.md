# Концепция
Если в двух словах, всё в лучших традициях REST API.

Взаимодействие между фронтом и беком осуществляется посредством обмена JSON-объектами. HTTP-глагол, отправляемый клиентом, обозначает действие, которое клиент хочет совершить:
* `GET` - получить данные
* `POST` - загрузить данные
* `PUT` - обновить существующие данные
* `DELETE` - удалить данные
* `OPTIONS` - список доступных методов для данного URL
Сервер отвечает JSON-объектом с данными. HTTP код ответа является индикатором наличия или отсутствия ошибки:
* `400` - суть запроса непонятна
* `401` - необходима авторизация
* `403` - доступ запрещён
* `415` - фактический формат переданного файла не поддерживается. Также может возвращаться, если не удалось распарсить JSON запроса, или сам запрос пришёл не в формате JSON.
* `419` - клиенту нужно пройти повторную авторизацию (например, протухли куки или CSRF токены). При этом на клиенте могут быть несохранённые данные, которые будут потеряны, если просто выкинуть клиента на страницу авторизации.
* `422` - содержание запроса не прошло серверную валидацию
* `500` - ошибка исполнения
* `501` - метод не реализован

Подробнее можно почитать, например, [тут](https://habr.com/ru/articles/447322/) или [там](https://habr.com/ru/articles/590679/).

# Реализация
## Бекенд
### Метод
Чтобы реализовать метод, используем декоратор, соответствующий HTTP-глаголу:
```
@router.put("/page/{id}", tags=["todos"])
async def add_page(id: int, body: dict) -> dict:
    return {
        "data": f"Todo with id {id} not found."
    }
```
Вместо `put` может быть `get`, `post` и так дале.
### Код и заголовки ответа
Код ответа можно указать прямо в декораторе:
```
@app.post("/items/", status_code=201)
```
Если статусный код нужно изменить по ходу выполнения функции, вот пример:
```
from fastapi import FastAPI, Response, Path
 
app = FastAPI()
 
@app.get("/users/{id}", status_code=200)
def users(response: Response, id: int = Path()):
    if id < 1:
        response.status_code = 400
        return {"message": "Incorrect Data"}
    return  {"message": f"Id = {id}"}
```
Об отправке и получении заголовков написано [здесь](https://metanit.com/python/fastapi/1.13.php).


## Фронтенд
В REST API сделано всё для простоты использования на фронте, любой вопрос решается базовыми возможностями `fetch`. Пример (добавляем объект `newTodo` с помощью метода `todo/add`):
```
fetch("http://localhost:8000/todo/add", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(newTodo)
}).then(fetchTodos)
```
Достаточно полное руководство по работе с `fetch` доступно [туть](https://learn.javascript.ru/fetch).